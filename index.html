<!DOCTYPE html>
<html>
  <head>
    <title>Chatbot</title>
    <link rel="stylesheet" href="/style.css" />
    <style>
      #chatlog {
        height: 200px;
        overflow: scroll;
      }
    </style>
  </head>
  <body>
    <h1>Chatbot</h1>
    <div id="chatlog"></div>
    <input type="text" id="message" placeholder="Type your message here" />
    <button id="send">Send</button>
    <button id="save">Save</button>
    <script>
      const chatlog = document.getElementById('chatlog');
      const messageInput = document.getElementById('message');
      const sendButton = document.getElementById('send');
      const saveButton = document.getElementById('save');

      // Define a function to append a message to the chat log
      function appendMessage(message) {
        const p = document.createElement('p');
        p.innerText = message;
        chatlog.appendChild(p);
      }

      // Define a function to send a message to the backend and append the response to the chat log
      async function sendMessage() {
        const message = messageInput.value;
        const response = await fetch('/api/message', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ message: message })
        });
        const text = await response.text();
        appendMessage(`You: ${message}`);
        appendMessage(`Chatbot: ${text}`);
        messageInput.value = '';
      }

      // Define a function to save the chat log to the backend
      async function saveChatLog() {
        const chatlog = Array.from(chatlog.children).map(el => el.innerText);
        const response = await fetch('/api/save', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ chatlog: chatlog })
        });
        const text = await response.text();
        alert(text);
      }

      // Attach event listeners to the send and save buttons
      sendButton.addEventListener('click', sendMessage);
      saveButton.addEventListener('click', saveChatLog);
    </script>
    <script src="/app.js"></script>
  </body>
</html>
